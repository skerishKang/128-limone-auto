(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{9017:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/files",function(){return s(2394)}])},3954:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(5893),l=s(7294);function a(e){let{message:t,onRetry:s,type:a="error"}=e,[n,o]=(0,l.useState)(!0);if(!n)return null;let c={error:{container:"bg-red-50 border-red-200 text-red-800",icon:"text-red-500",button:"bg-red-100 hover:bg-red-200 text-red-800"},warning:{container:"bg-yellow-50 border-yellow-200 text-yellow-800",icon:"text-yellow-500",button:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800"},info:{container:"bg-blue-50 border-blue-200 text-blue-800",icon:"text-blue-500",button:"bg-blue-100 hover:bg-blue-200 text-blue-800"}}[a];return(0,r.jsxs)("div",{className:"rounded-lg border p-4 ".concat(c.container),children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0 ".concat(c.icon),children:(0,r.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3 flex-1",children:(0,r.jsx)("p",{className:"text-sm font-medium",children:t})}),(0,r.jsx)("div",{className:"ml-auto pl-3",children:(0,r.jsxs)("button",{onClick:()=>o(!1),className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 rounded",children:[(0,r.jsx)("span",{className:"sr-only",children:"닫기"}),(0,r.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]}),s&&(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("button",{onClick:s,className:"px-3 py-1.5 text-sm font-medium rounded-md transition-colors ".concat(c.button),children:"다시 시도"})})]})}},3411:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(5893);function l(e){let{size:t="md",color:s="text-blue-500"}=e;return(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsx)("div",{className:"".concat({sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[t]," ").concat(s," animate-spin"),style:{border:"2px solid currentColor",borderTop:"2px solid transparent",borderRadius:"50%"}})})}},2394:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var r=s(5893),l=s(7294),a=s(4753),n=s(3411),o=s(3954);function c(e){let{onUploadComplete:t,acceptedTypes:s=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png",maxSize:c=10}=e,{isUploading:i,uploadProgress:d,error:u,uploadFile:x}=function(){let[e,t]=(0,l.useState)(!1),[s,r]=(0,l.useState)(0),[n,o]=(0,l.useState)(null),[c,i]=(0,l.useState)(null);return{isUploading:e,uploadProgress:s,error:n,uploadResult:c,uploadFile:(0,l.useCallback)(async e=>{try{t(!0),o(null),r(0),i(null),r(30);let s=await a.E.uploadFile(e);return r(100),i(s),s}catch(e){throw o(e instanceof Error?e.message:"Upload failed"),console.error("File upload error:",e),e}finally{t(!1)}},[]),getFiles:(0,l.useCallback)(async()=>{try{return o(null),await a.E.getFiles()}catch(e){throw o(e instanceof Error?e.message:"Failed to fetch files"),console.error("Get files error:",e),e}},[]),deleteFile:(0,l.useCallback)(async e=>{try{return o(null),await a.E.deleteFile(e),{success:!0}}catch(e){throw o(e instanceof Error?e.message:"Failed to delete file"),console.error("Delete file error:",e),e}},[])}}(),[h,m]=(0,l.useState)(!1),g=(0,l.useRef)(null),f=async e=>{try{if(e.size>1048576*c){alert("파일 크기가 ".concat(c,"MB를 초과합니다"));return}let s=await x(e);t&&t(s)}catch(e){console.error("Upload error:",e)}},p=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?m(!0):"dragleave"===e.type&&m(!1)};return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:e=>{var t;e.preventDefault(),e.stopPropagation(),m(!1);let s=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];s&&f(s)},onClick:()=>{var e;null===(e=g.current)||void 0===e||e.click()},className:"\n          relative border-2 border-dashed rounded-xl p-8\n          cursor-pointer transition-all\n          ".concat(h?"border-yellow-400 bg-yellow-50":"border-gray-300 hover:border-yellow-400 hover:bg-gray-50","\n        "),children:[(0,r.jsx)("input",{ref:g,type:"file",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&f(s)},accept:s,className:"hidden",disabled:i}),(0,r.jsx)("div",{className:"text-center",children:i?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(n.Z,{size:"lg"}),(0,r.jsx)("p",{className:"text-gray-600",children:"업로드 중..."}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-yellow-400 h-2 rounded-full transition-all",style:{width:"".concat(d,"%")}})}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[d,"% 완료"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCC1"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-700",children:"파일을 드래그하거나 클릭하여 업로드"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["지원 형식: ",s," | 최대 ",c,"MB"]}),(0,r.jsx)("button",{type:"button",className:" mt-4 px-6 py-2 bg-yellow-400 hover:bg-yellow-500 text-gray-900 rounded-lg font-medium transition-colors ",children:"파일 선택"})]})})]}),u&&(0,r.jsx)(o.Z,{message:u})]})}function i(){let[e,t]=(0,l.useState)([]),[s,i]=(0,l.useState)(!1),[d,u]=(0,l.useState)(null),[x,h]=(0,l.useState)(null),m=async()=>{try{i(!0),u(null);let e=await a.E.getFiles();t(e)}catch(e){u(e instanceof Error?e.message:"Failed to load files")}finally{i(!1)}},g=async s=>{if(confirm("'".concat(s,"' 파일을 삭제하시겠습니까?")))try{await a.E.deleteFile(s),t(e.filter(e=>e.filename!==s))}catch(e){u(e instanceof Error?e.message:"Delete failed")}};return(0,l.useEffect)(()=>{m()},[]),(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"\uD83D\uDCC1 파일 관리"}),(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"파일 업로드"}),(0,r.jsx)(c,{onUploadComplete:e=>{h(e),m()},acceptedTypes:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.csv",maxSize:10})]}),x&&(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"업로드 결과"}),(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-green-800",children:x.result}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:[(0,r.jsxs)("p",{children:["파일명: ",x.filename]}),(0,r.jsxs)("p",{children:["크기: ",(x.size/1024).toFixed(2)," KB"]})]})]})]}),d&&(0,r.jsx)(o.Z,{message:d}),(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"업로드된 파일"}),(0,r.jsx)("button",{onClick:m,disabled:s,className:" px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors ",children:s?(0,r.jsx)(n.Z,{size:"sm"}):"새로고침"})]}),s?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)(n.Z,{})}):0===e.length?(0,r.jsx)("div",{className:"text-center py-12 text-gray-500",children:(0,r.jsx)("p",{children:"업로드된 파일이 없습니다"})}):(0,r.jsx)("div",{className:"space-y-3",children:e.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"text-2xl",children:e.filename.includes(".pdf")?"\uD83D\uDCC4":e.filename.match(/\.(jpg|jpeg|png|gif)/)?"\uD83D\uDDBC️":e.filename.match(/\.(doc|docx)/)?"\uD83D\uDCDD":"\uD83D\uDCC1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-800",children:e.filename}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[(e.size/1024).toFixed(2)," KB",e.created_at&&" • ".concat(new Date(1e3*e.created_at).toLocaleDateString("ko-KR"))]})]})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsx)("button",{onClick:()=>g(e.filename),className:" px-3 py-1 text-sm bg-red-100 hover:bg-red-200 text-red-700 rounded transition-colors ",children:"삭제"})})]},t))})]})]})})}},4753:function(e,t,s){"use strict";s.d(t,{E:function(){return l}});class r{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(this.baseUrl).concat(e),r={headers:{"Content-Type":"application/json",...t.headers},...t};try{let e=await fetch(s,r);if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.detail||"HTTP error! status: ".concat(e.status))}return await e.json()}catch(t){throw console.error("API request failed: ".concat(e),t),t}}async getConversations(){return this.request("/api/chat/conversations")}async createConversation(e){return this.request("/api/chat/conversations",{method:"POST",body:JSON.stringify({title:e||"New Chat"})})}async getConversationMessages(e){return this.request("/api/chat/conversations/".concat(e,"/messages"))}async sendMessage(e,t){return this.request("/api/chat/conversations/".concat(e,"/messages"),{method:"POST",body:JSON.stringify({content:t})})}async deleteConversation(e){return this.request("/api/chat/conversations/".concat(e),{method:"DELETE"})}async uploadFile(e){let t=new FormData;return t.append("file",e),this.request("/api/files/upload",{method:"POST",body:t,headers:{}})}async getFiles(){return this.request("/api/files/list")}async deleteFile(e){return this.request("/api/files/delete/".concat(e),{method:"DELETE"})}connectWebSocket(e,t){let s=new WebSocket("ws://localhost:8000/ws/chat/".concat(e));return s.onmessage=e=>{try{let s=JSON.parse(e.data);t(s)}catch(e){console.error("WebSocket message parse error:",e)}},s.onerror=e=>{console.error("WebSocket error:",e)},s.onclose=()=>{console.log("WebSocket connection closed")},s}constructor(e="http://localhost:8000"){this.baseUrl=e}}let l=new r}},function(e){e.O(0,[323,747,657,888,179],function(){return e(e.s=9017)}),_N_E=e.O()}]);